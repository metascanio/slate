
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Metascan - API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;php&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="php">php</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#api-introduction" class="toc-h1 toc-link" data-title="API Introduction">API Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#api-overview" class="toc-h1 toc-link" data-title="API Overview">API Overview</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#query-formats" class="toc-h2 toc-link" data-title="API Overview">Query formats</a>
                  </li>
                  <li>
                    <a href="#ip-addresses" class="toc-h2 toc-link" data-title="API Overview">IP Addresses</a>
                  </li>
                  <li>
                    <a href="#domains" class="toc-h2 toc-link" data-title="API Overview">Domains</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#http-format" class="toc-h1 toc-link" data-title="HTTP Format">HTTP Format</a>
          </li>
          <li>
            <a href="#text-format" class="toc-h1 toc-link" data-title="Text Format">Text Format</a>
          </li>
          <li>
            <a href="#json-format" class="toc-h1 toc-link" data-title="JSON Format">JSON Format</a>
          </li>
          <li>
            <a href="#jsonx-format" class="toc-h1 toc-link" data-title="JSONX Format">JSONX Format</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#jsonx-response" class="toc-h2 toc-link" data-title="JSONX Format">JSONX response:</a>
                  </li>
                  <li>
                    <a href="#query-parameters" class="toc-h2 toc-link" data-title="JSONX Format">Query Parameters</a>
                  </li>
                  <li>
                    <a href="#bot" class="toc-h2 toc-link" data-title="JSONX Format">Bot</a>
                  </li>
                  <li>
                    <a href="#smtp" class="toc-h2 toc-link" data-title="JSONX Format">SMTP</a>
                  </li>
                  <li>
                    <a href="#multiple-items" class="toc-h2 toc-link" data-title="JSONX Format">Multiple items</a>
                  </li>
                  <li>
                    <a href="#browser-access" class="toc-h2 toc-link" data-title="JSONX Format">Browser access</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#dns-api" class="toc-h1 toc-link" data-title="DNS API">DNS API</a>
          </li>
          <li>
            <a href="#dns-response-codes" class="toc-h1 toc-link" data-title="DNS Response codes">DNS Response codes</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#127-0-0-x" class="toc-h2 toc-link" data-title="DNS Response codes">127.0.0.x</a>
                  </li>
                  <li>
                    <a href="#127-0-1-x" class="toc-h2 toc-link" data-title="DNS Response codes">127.0.1.x</a>
                  </li>
                  <li>
                    <a href="#127-1-0-x" class="toc-h2 toc-link" data-title="DNS Response codes">127.1.0.x</a>
                  </li>
                  <li>
                    <a href="#127-8-0-x" class="toc-h2 toc-link" data-title="DNS Response codes">127.8.0.x</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#metascan-overview" class="toc-h1 toc-link" data-title="Metascan Overview">Metascan Overview</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#data-amp-access-methods" class="toc-h2 toc-link" data-title="Metascan Overview">Data &amp; Access Methods</a>
                  </li>
                  <li>
                    <a href="#score-calculation" class="toc-h2 toc-link" data-title="Metascan Overview">Score calculation</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#data-sources" class="toc-h1 toc-link" data-title="Data Sources">Data Sources</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#ip-addresses-sources" class="toc-h2 toc-link" data-title="Data Sources">IP Addresses sources</a>
                  </li>
                  <li>
                    <a href="#domains-sources" class="toc-h2 toc-link" data-title="Data Sources">Domains sources</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://metascan.io/signup/?lang=en'>Sign Up for a Developer Key</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='api-introduction'>API Introduction</h1>
<blockquote>
<p>API endpoint:</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.metascan.io/
</code></pre>
<p>The Metascan Query Services <code>&quot;MQS&quot;</code> was created to facilitate the real-time lookup of IP and Domain threat data into various applications and services. Currently there are dozens of various domain and IP data-feeds available to developers. Many of these feeds are available free of charge and some are paid for services when minimum query levels are exceeded. In addition, there are 2 main problems with trying to incorporate multiple data feed into a solution:</p>

<ol>
<li><p>The overlap between data feed providers in the content listed (IPs &amp; URIs), and</p></li>
<li><p>The absence of normalized meta-data related to the IPs or Domains.</p></li>
</ol>

<p>Because of the above, many developers asked if we could do something to reduce the complexity related to accessing and using threat data as part of their applications - MQS is our solution. We are introducing a <em>more elegant API for developers</em>, with an affordable pricing model to match.</p>

<p>To start, <a href="https://metascan.io/signup/?lang=en">signup for a developer key</a> and begin to integrate MQS into your web-apps and mobile applications. </p>
<h1 id='authentication'>Authentication</h1>
<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl https://api.metascan.io/?key<span class="o">=</span>YOURAPIKEY
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.metascan.io/?key=YOURAPIKEY'</span><span class="p">);</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre><pre class="highlight javascript tab-javascript"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<span class="na">type</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
<span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.metascan.io/?key=YOURAPIKEY'</span><span class="p">,</span>
<span class="na">dataType</span><span class="p">:</span> <span class="s1">'JSON'</span><span class="p">,</span>
<span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">},</span>

<span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">}</span>

<span class="p">});</span>
</code></pre>
<p>All queries to MSQ require your API key specified as an argument. No API key? <a href="https://metascan.io/signup/?lang=en'">Signup and receive</a> a key instantly. </p>

<blockquote>
<p>Make sure to replace <code>YOURAPIKEY</code> with your API key.</p>
</blockquote>

<p>MSQ uses API keys to allow access to the service, and expects the API key to be included in all requests to the server.</p>

<aside class="notice">
You must replace <code>YOURAPIKEY</code> with your personal API key.
</aside>
<h1 id='api-overview'>API Overview</h1><h2 id='query-formats'>Query formats</h2>
<blockquote>
<p>Query end-points include 4 formatting options:</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.metascan.io/v1/check/http/
</code></pre><pre class="highlight plaintext"><code>https://api.metascan.io/v1/check/text/
</code></pre><pre class="highlight plaintext"><code>https://api.metascan.io/v1/check/json/
</code></pre><pre class="highlight plaintext"><code>https://api.metascan.io/v1/check/jsonx/
</code></pre>
<p>You can issue requests to our endpoints from virtually any operating system or programming language. REST queries are extremely fast and provide the reachest set of information about an item. For example, the Spamhaus&#39; CBL data is available only via REST JSONX query.</p>

<p>Each client has unique access key, generated by the system. You need to provide this key, if querying from an unregistered IP address. Requests from unregistered IP address are rejected, if not performed over HTTPS (secure).</p>

<p>There are four types of REST queries:</p>

<ul>
<li>HTTP</li>
<li>Text</li>
<li>JSON</li>
<li>JSONX.</li>
</ul>

<p>The type of desired query is passed in the HTTP request.</p>
<h2 id='ip-addresses'>IP Addresses</h2>
<p>We provide four IPv4 and four IPv6 addresses, which will always return the same answers. Use those for testing and development:</p>

<ul>
<li><code>127.9.9.1</code> - returning as if found in SBL, XBL &amp; CBL</li>
<li><code>127.9.9.2</code> - returning as if in PBL</li>
<li><code>127.9.9.3</code> - returning as if in SBL subnet</li>
<li><code>127.9.9.4</code> - not found (good IP), also contains White List data</li>
<li><code>::1, ::2, ::3, ::4</code> - returning as above for IPv6.</li>
</ul>
<h2 id='domains'>Domains</h2>
<p>We provide two testing domains:</p>

<ul>
<li><p><code>baddomain.org</code> - returns as if found in all domain DBs: DBL, and all URIBL</p></li>
<li><p><code>okdomain.org</code> - returns as if not found in any DB.</p></li>
</ul>
<h1 id='http-format'>HTTP Format</h1><pre class="highlight shell tab-shell"><code>curl https://api.metascan.io/v1/check/http/baddomain.org?key<span class="o">=</span>YOURAPIKEY
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.metascan.io/v1/check/http/baddomain.org?key=YOURAPIKEY'</span><span class="p">);</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<span class="na">type</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
<span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.metascan.io/v1/check/http/baddomain.org?key=YOURAPIKEY'</span><span class="p">,</span>
<span class="na">dataType</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
<span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">},</span>

<span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">}</span>

<span class="p">});</span>
</code></pre><pre class="highlight plaintext"><code>HTTP 200 (OK).

If the item is not present in any black list, then the answer will be 204 (No Content).
</code></pre>
<p>HTTP returns very simple response - found or not, via HTTP response code. If found, the response will be 200 (OK).</p>

<p>If the item is not present in any black list, then the answer will be 204 (No Content).</p>

<p>Additional information about the item is found in the response headers. Check the Developers page for more information.</p>

<p>HTTP example - replace &#39;baddomain.org&#39; with your query - IP or domain:</p>
<h1 id='text-format'>Text Format</h1><pre class="highlight shell tab-shell"><code>curl https://api.metascan.io/v1/check/text/baddomain.org?key<span class="o">=</span>YOURAPIKEY
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.metascan.io/v1/check/text/baddomain.org?key=YOURAPIKEY'</span><span class="p">);</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<span class="na">type</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
<span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.metascan.io/v1/check/text/baddomain.org?key=YOURAPIKEY'</span><span class="p">,</span>
<span class="na">dataType</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
<span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">},</span>

<span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">}</span>

<span class="p">});</span>
</code></pre>
<blockquote>
<p>The above example returns text in the format:</p>
</blockquote>
<pre class="highlight plaintext"><code>127.9.9.4:false,true,med;metascan.io;99999,-0.1 127.9.9.1:true,false,,0.95,xbl,sbl
</code></pre>
<p>TEXT returns space separated blocks of information about the lists where the item is found.</p>

<p>Text example - replace &#39;baddomain.com&#39; with your query - IP or domain:</p>

<p>Items are separated by space. The format for each item is:</p>

<p><code>item:bool,bool,wldata,score,source</code></p>

<p>Where:</p>

<ul>
<li><p>the first bool is true, if found in any black list,</p></li>
<li><p>the second bool is true, if found in any white list,</p></li>
<li><p>wldata contains the data from the white list, and</p></li>
<li><p>score is followed by the list of sources where the item was found.</p></li>
</ul>
<h1 id='json-format'>JSON Format</h1><pre class="highlight shell tab-shell"><code>curl https://api.metascan.io/v1/check/json/baddomain.org?key<span class="o">=</span>yourkeygoeshere
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.metascan.io/v1/check/json/baddomain.org?key=YOURAPIKEY'</span><span class="p">);</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="k">echo</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span>

<span class="cp">?&gt;</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<span class="na">type</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
<span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.metascan.io/v1/check/json/baddomain.org?key=YOURAPIKEY'</span><span class="p">,</span>
<span class="na">dataType</span><span class="p">:</span> <span class="s1">'JSON'</span><span class="p">,</span>
<span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">},</span>

<span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">}</span>

<span class="p">});</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"item"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123.123.123.123"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"found"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"score"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fromSubnet"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"shPBL"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"wl"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"wldata"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"executionTime"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>JSON will return a JSON document with details about black lists, whether the item was found in a subnet, etc. See format explanation below. JSON example - replace &#39;baddomain.org&#39; with your query - IP or domain:</p>

<p>JSON response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Item</td>
<td>IP address</td>
</tr>
<tr>
<td>Found</td>
<td>True/False if found in MQS</td>
</tr>
<tr>
<td>Score</td>
<td>Score between -0.1 to 1.0. See <a href="#score-calculation">score information</a></td>
</tr>
<tr>
<td>FromSubnet</td>
<td>Will be true, if the IP address was found in a subnet (PBL, SBL)</td>
</tr>
<tr>
<td>Sources</td>
<td>Lists matched from MQS. <a href="#data-amp-access-methods">See list</a> information.</td>
</tr>
<tr>
<td>Wl</td>
<td>To be specified</td>
</tr>
<tr>
<td>Wldata</td>
<td>To be specified</td>
</tr>
<tr>
<td>ExecutionTime</td>
<td>Time in ms for server response</td>
</tr>
<tr>
<td>Status</td>
<td>Success or failure</td>
</tr>
</tbody></table>
<h1 id='jsonx-format'>JSONX Format</h1><pre class="highlight shell tab-shell"><code>curl https://api.metascan.io/v1/check/jsonx/baddomain.org?key<span class="o">=</span>yourkeygoeshere
</code></pre><pre class="highlight php tab-php"><code><span class="cp">&lt;?</span>
<span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="s1">'https://api.metascan.io/v1/check/jsonx/baddomain.org?key=YOURAPIKEY'</span><span class="p">);</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="k">echo</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span>

<span class="cp">?&gt;</span>
</code></pre><pre class="highlight javascript tab-javascript"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
<span class="na">type</span><span class="p">:</span> <span class="s1">'GET'</span><span class="p">,</span>
<span class="na">url</span><span class="p">:</span> <span class="s1">'https://api.metascan.io/v1/check/jsonx/baddomain.org?key=YOURAPIKEY'</span><span class="p">,</span>
<span class="na">dataType</span><span class="p">:</span> <span class="s1">'JSON'</span><span class="p">,</span>
<span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
<span class="p">},</span>

<span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
<span class="p">}</span>

<span class="p">});</span>
</code></pre>
<p>JSONX will return also a JSON document, extended with additional information about the last known activity of an fraudulent IP address. There are no jsonx queries for domains. Jsonx example - replace &#39;baddomain.com&#39; with your query - IP or domain:</p>

<aside class="success">
Use JSONX if you require extended information regarding the queried host.
</aside>
<h3 id='jsonx-response'>JSONX response:</h3>
<p>It includes additional information about an IP address with fraudulent activity. This information is found in the &#39;extended&#39; and &#39;emailsdaily&#39; fields, e.g.:</p>
<h3 id='query-parameters'>Query Parameters</h3><pre class="highlight json tab-json"><code><span class="s2">"extended"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"ASNum"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23969"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.200.0/24"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AU"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"veridas.net"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1486447729"</span><span class="p">,</span><span class="w">

      </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BOT"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"rule"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9904"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sinkhole"</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"conficker"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"104.244.14.252"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"80"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sourceport"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23915"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ASNum</td>
<td>The autonomous system number of the ISP;</td>
</tr>
<tr>
<td>route</td>
<td>The address of the network / subnet from which the activity originated;</td>
</tr>
<tr>
<td>country</td>
<td>The location of the above network;</td>
</tr>
<tr>
<td>domain</td>
<td>The associated domain with the ip address;</td>
</tr>
<tr>
<td>state</td>
<td>Display the state (if available);</td>
</tr>
<tr>
<td>time</td>
<td>The last registered activity timestamp in unix epoch format;</td>
</tr>
<tr>
<td>emailsdaily</td>
<td>Contains the number of detected spam emails in the last 24 hours;</td>
</tr>
</tbody></table>

<p>For SMTP use, the <code>reason</code> JSON response will extend information based on the EHLO/SMTP reputation of the queried IP. Results include:</p>
<h2 id='bot'>Bot</h2>
<p>JSONX provides extended information to protect your web-site or mobile application, especially for user signup forms, login and integrations to your application.</p>

<p>JSONX returns a <code>BOT</code> class, which represents one of the following 5 types:</p>
<h3 id='sinkhole'>Sinkhole</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"9091"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"sinkhole"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"marcher"</span><span class="p">,</span><span class="w"> </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">"216.218.185.162"</span><span class="p">,</span><span class="w"> </span><span class="s2">"port"</span><span class="p">:</span><span class="s2">"80"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sourceport"</span><span class="p">:</span><span class="s2">"n/a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"destination"</span><span class="p">:</span><span class="s2">"onoven.com"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Sinkhole</td>
</tr>
<tr>
<td>Source</td>
<td>Source IP</td>
</tr>
<tr>
<td>Port</td>
<td>Source Port</td>
</tr>
</tbody></table>
<h3 id='web-server-compromises'>Web Server Compromises</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"20062"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"spamlink"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domain"</span><span class="p">:</span><span class="s2">"www.thefashionic.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">"1.53.132.24"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"gamut"</span><span class="p">,</span><span class="w"> </span><span class="s2">"link"</span><span class="p">:</span><span class="s2">"https://www.thefashionic.com/wp-content/themes/thevoux-wp/f3ebf56b6f.html"</span><span class="p">,</span><span class="w"> </span><span class="s2">"redirect"</span><span class="p">:</span><span class="s2">"https://targetsale.name"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Spamlink</td>
</tr>
<tr>
<td>Domain</td>
<td>Spam domain</td>
</tr>
<tr>
<td>Source</td>
<td>Source IP</td>
</tr>
<tr>
<td>Link</td>
<td>Typed link, e.g. as it appears to user</td>
</tr>
<tr>
<td>Redirect</td>
<td>Real link destination</td>
</tr>
</tbody></table>
<h3 id='web-server-attacks'>Web Server Attacks</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"9051"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"web server attack"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"commentspammer"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Web Server Attack</td>
</tr>
<tr>
<td>Name</td>
<td>Extended Information</td>
</tr>
</tbody></table>
<h3 id='miscellaneous'>Miscellaneous</h3>
<p>In this case, attempted user and password are also listed. Note that these fields are not always present.</p>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"9803"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"miscellaneous"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"iotwopbot"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user"</span><span class="p">:</span><span class="s2">"root"</span><span class="p">,</span><span class="w"> </span><span class="s2">"password"</span><span class="p">:</span><span class="s2">"anko"</span><span class="p">,</span><span class="w"> </span><span class="s2">"port"</span><span class="p">:</span><span class="s2">"5358"</span><span class="p">,</span><span class="w"> </span><span class="s2">"source"</span><span class="p">:</span><span class="s2">"198.133.159.133"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sourceport"</span><span class="p">:</span><span class="s2">"53234"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domain"</span><span class="p">:</span><span class="s2">"-"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Miscellaneous</td>
</tr>
<tr>
<td>Name</td>
<td>Attack name</td>
</tr>
<tr>
<td>User</td>
<td>Attempted username login</td>
</tr>
<tr>
<td>Pass</td>
<td>Attempted password</td>
</tr>
<tr>
<td>Port</td>
<td>Port address</td>
</tr>
<tr>
<td>Source</td>
<td>Source IP</td>
</tr>
<tr>
<td>SourcePort</td>
<td>Source Port address</td>
</tr>
<tr>
<td>Domain</td>
<td>Domain specified</td>
</tr>
</tbody></table>
<h3 id='unknown'>Unknown</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOT"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rule"</span><span class="p">:</span><span class="s2">"3013"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"unknown"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="s2">"unknown3013"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"pharmaccccyyy.ca"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Rule</td>
<td>The detection rule ID</td>
</tr>
<tr>
<td>Type</td>
<td>Unknown</td>
</tr>
<tr>
<td>Name</td>
<td>Attack name</td>
</tr>
<tr>
<td>Halo</td>
<td>SMTP Halo specified</td>
</tr>
</tbody></table>
<h2 id='smtp'>SMTP</h2>
<p>If using MQS for MTA/SMTP security, JSONX provides extended information that can assist with spam detection and email security for end-user mailboxes.</p>
<h3 id='loc'>LOC</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"LOC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"helos as destination server"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>LOC</td>
<td>SMTP &quot;helos&quot; as destination server</td>
</tr>
</tbody></table>
<h3 id='mpd'>MPD</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"MPD"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"helos as multiple unrelated domains"</span><span class="p">,</span><span class="w"> </span><span class="s2">"heloscount"</span><span class="p">:</span><span class="s2">"16"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domainscount"</span><span class="p">:</span><span class="s2">"16"</span><span class="p">,</span><span class="w"> </span><span class="s2">"domains"</span><span class="p">:[</span><span class="s2">"daycoonline.net"</span><span class="p">,</span><span class="w"> </span><span class="s2">"e-apollo.lv"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exitprofit.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"flammhotclicks.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ftc-i.net"</span><span class="p">,</span><span class="w"> </span><span class="s2">"happyhumans.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hctc.net"</span><span class="p">,</span><span class="w"> </span><span class="s2">"heronaerospace.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hi.nl"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hot.dog.cx"</span><span class="p">,</span><span class="w"> </span><span class="s2">"i-love-cats.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"investonline.biz"</span><span class="p">,</span><span class="w"> </span><span class="s2">"kafen.com"</span><span class="p">]}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>MPD</td>
<td>helos as multiple unrelated domains</td>
</tr>
<tr>
<td>heloscount</td>
<td>Number of unique HELO attempts</td>
</tr>
<tr>
<td>domainscount</td>
<td>Number of unique domains on HELO attempts</td>
</tr>
<tr>
<td>domains</td>
<td>JSON array for the domains used for HELO attempts</td>
</tr>
</tbody></table>
<h3 id='never'>Never</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"NEVER"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"forged helos"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"hotmail.com"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NEVER</td>
<td>Usually forged helos</td>
</tr>
</tbody></table>
<h3 id='misc'>Misc</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"MISC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"specific broken helos"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"device.lan"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>MISC</td>
<td>Usually specific broken helos</td>
</tr>
</tbody></table>
<h3 id='bogus'>Bogus</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BOGUS"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"multiple illegal helos"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halos"</span><span class="p">:[</span><span class="s2">"impedibilityz"</span><span class="p">,</span><span class="s2">"recanterp"</span><span class="p">,</span><span class="s2">"stanchedb"</span><span class="p">]}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>BOGUS</td>
<td>Multiple illegal helos</td>
</tr>
<tr>
<td>Halos</td>
<td>JSON array of malformed domains that do not comply with RFC822</td>
</tr>
</tbody></table>
<h3 id='bsip'>BSIP</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"BSIP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"illegal helo as IP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"109.242.179.132"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>BSIP</td>
<td>Illegal helo`ing as IP</td>
</tr>
<tr>
<td>Halo</td>
<td>Malformed IP address used to HELO</td>
</tr>
</tbody></table>
<h3 id='ssip'>SSIP</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"SSIP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"illegal helo as own IP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"120.215.192.35"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SSIP</td>
<td>Illegal helo`ing as own IP</td>
</tr>
<tr>
<td>Halo</td>
<td>Source IP address</td>
</tr>
</tbody></table>
<h3 id='lh'>LH</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"SSIP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"illegal helo as own IP"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"120.215.192.35"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>* LH</td>
<td>Variations on localhost</td>
</tr>
</tbody></table>
<h3 id='fam'>FAM</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"FAM"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"helos as someone we know they`re not"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rdns"</span><span class="p">:</span><span class="s2">"ppp-93-104-64-20.dynamic.mnet-online.de"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"striker.ottawa.on.ca"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>FAM</td>
<td>Helos as someone we know they`re not</td>
</tr>
<tr>
<td>rdns</td>
<td>Reverse dns of the offending IP</td>
</tr>
</tbody></table>
<h3 id='nohelo'>NOHELO</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"NOHELO"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NOHELO</td>
<td>Missing Helo</td>
</tr>
</tbody></table>
<h3 id='heli'>HELI</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"class"</span><span class="p">:</span><span class="s2">"HELI"</span><span class="p">,</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"special category"</span><span class="p">,</span><span class="w"> </span><span class="s2">"halo"</span><span class="p">:</span><span class="s2">"test654.com"</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>HELO</td>
<td>Special category for development purposes.</td>
</tr>
</tbody></table>
<h2 id='multiple-items'>Multiple items</h2><pre class="highlight plaintext"><code>http://api.metascan.io/v1/check/jsonx/127.9.9.1,baddomain.org,127.9.9.4,okdomain.org,::1
</code></pre>
<p>You can send multiple items in a single request. This will speed up the overall time for answering your query. Whenever possible, please use multiple items in a single query</p>
<h2 id='browser-access'>Browser access</h2>
<ul>
<li><p>Point your browser to <a href="https://metascan.io/query">https://metascan.io/query</a></p></li>
<li><p>Enter one or more IP addresses or domain names;</p></li>
</ul>

<p>Click Check.</p>

<p>The service will return list of results with details on where the items were found, query time, and calculated score</p>

<p>Note: a 5 second delay is applied to all anonymous user queries. Please register to remove this delay.</p>
<h1 id='dns-api'>DNS API</h1>
<p>We are providing an rbldns-like server that combines the information from all the sources we aggregate.</p>

<p>You should direct your DNS or anti-spam software to query <code>api.metascan.io</code></p>

<p>The query string shall be the domain name or IP address, like:</p>

<p><code>
baddomain.org
</code></p>

<p>Or:</p>

<p><code>127.9.9.1 or 1234:5678:9abc::</code></p>

<p><em>(not reversed IP, if query type is &#39;A&#39;)</em></p>

<p>Or:</p>

<p><code>reversed as 1.9.9.127.in-addr.arpa</code></p>

<p><code>0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.c.b.a.9.8.7.6.5.4.3.2.1.ip6.arpa</code></p>

<p><em>if query type is &#39;PTR&#39;</em></p>

<p>The server will reply either with a 127.x.x.x code (if the item is in our lists), or with NXDOMAIN response, if the item is not found.</p>

<aside class="notice">
Note that for both IPv4 and IPv6 addresses we only return IPv4 response codes!
</aside>

<aside class="notice">
DNS queries from unregistered IP addresses will be rejected. You need to register all IPs of the machines issuing DNS queries to our servers.
</aside>

<p>Sample dig syntax:</p>

<p><code>dig @api.metascan.io baddomain.org</code></p>

<p>Sample NSLOOKUP example:</p>

<p><code>nslookup baddomain.org api.metascan.io</code></p>

<p>Note: If you use Windows&#39; nslookup, you must set the following options: nodefname, nosearch.</p>
<h1 id='dns-response-codes'>DNS Response codes</h1><h2 id='127-0-0-x'>127.0.0.x</h2>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.0.0.x</td>
<td>PBL (Public/residential) IP adddresses from Spamhaus</td>
</tr>
<tr>
<td>127.0.0.10</td>
<td>reported by ISP</td>
</tr>
<tr>
<td>127.0.0.11</td>
<td>detected by Spamhaus</td>
</tr>
<tr>
<td>127.0.0.x</td>
<td>IP lists from Spamhaus</td>
</tr>
<tr>
<td>127.0.0.4</td>
<td>XBL Illegal 3rd party exploits, including proxies, worms and trojan exploits</td>
</tr>
<tr>
<td>127.0.0.2</td>
<td>SBL Spamhaus SBL Data</td>
</tr>
<tr>
<td>127.0.0.3</td>
<td>SBL Spamhaus SBL CSS Data</td>
</tr>
<tr>
<td>127.0.0.9</td>
<td>SBL Spamhaus DROP/EDROP Data</td>
</tr>
</tbody></table>
<h2 id='127-0-1-x'>127.0.1.x</h2>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.0.1.x</td>
<td>Domain lists from Spamhaus</td>
</tr>
<tr>
<td>127.0.1.2</td>
<td>spam domain</td>
</tr>
<tr>
<td>127.0.1.4</td>
<td>phish domain</td>
</tr>
<tr>
<td>127.0.1.5</td>
<td>malware domain</td>
</tr>
<tr>
<td>127.0.1.6</td>
<td>botnet C&amp;C domain</td>
</tr>
<tr>
<td>127.0.1.102</td>
<td>abused legit spam</td>
</tr>
<tr>
<td>127.0.1.103</td>
<td>abused spammed redirector domain</td>
</tr>
<tr>
<td>127.0.1.104</td>
<td>abused legit phish</td>
</tr>
<tr>
<td>127.0.1.105</td>
<td>abused legit malware</td>
</tr>
<tr>
<td>127.0.1.106</td>
<td>abused legit botnet C&amp;C</td>
</tr>
<tr>
<td>127.0.1.200</td>
<td>Zero reputation domain</td>
</tr>
</tbody></table>
<h2 id='127-1-0-x'>127.1.0.x</h2>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.1.0.x</td>
<td>Domain lists from URIBL</td>
</tr>
<tr>
<td>127.1.0.1</td>
<td>Black</td>
</tr>
<tr>
<td>127.1.0.2</td>
<td>Gold</td>
</tr>
<tr>
<td>127.1.0.3</td>
<td>Grey</td>
</tr>
<tr>
<td>127.1.0.4</td>
<td>Red</td>
</tr>
</tbody></table>
<h2 id='127-8-0-x'>127.8.0.x</h2>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>127.8.0.x</td>
<td>IP White lists from DNSWL</td>
</tr>
<tr>
<td>127.8.x.1</td>
<td>None, auto-discovered</td>
</tr>
<tr>
<td>127.8.x.2</td>
<td>Low ranking</td>
</tr>
<tr>
<td>127.8.x.3</td>
<td>Medium ranking</td>
</tr>
<tr>
<td>127.8.x.4</td>
<td>High ranking,</td>
</tr>
</tbody></table>

<p>Where the third digit (x) means the type of industry:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>2</td>
<td>Financial services</td>
</tr>
<tr>
<td>3</td>
<td>Email Service Providers</td>
</tr>
<tr>
<td>4</td>
<td>Organisations (both for-profit [i.e. companies] and non-profit)</td>
</tr>
<tr>
<td>5</td>
<td>Service/network providers</td>
</tr>
<tr>
<td>6</td>
<td>Personal/private servers</td>
</tr>
<tr>
<td>7</td>
<td>Travel/leisure industry</td>
</tr>
<tr>
<td>8</td>
<td>Public sector/governments</td>
</tr>
<tr>
<td>9</td>
<td>Media and Tech companies</td>
</tr>
<tr>
<td>10</td>
<td>Some special cases</td>
</tr>
<tr>
<td>11</td>
<td>Education, academic</td>
</tr>
<tr>
<td>12</td>
<td>Healthcare</td>
</tr>
<tr>
<td>13</td>
<td>Manufacturing/Industrial</td>
</tr>
<tr>
<td>14</td>
<td>Retail/Wholesale/Services</td>
</tr>
<tr>
<td>15</td>
<td>Email Marketing Providers</td>
</tr>
<tr>
<td>20</td>
<td>Added through Self Service without specific category</td>
</tr>
</tbody></table>
<h1 id='metascan-overview'>Metascan Overview</h1><h2 id='data-amp-access-methods'>Data &amp; Access Methods</h2>
<p>The MQS service is accessible via 6 different methods: Browser queries, 4 REST services (Text, HTTP, JSON, JSONx) and DNS.</p>

<p>Currently we derive our results from several providers, including:</p>

<ul>
<li>Spamhaus</li>
<li>Spamhaus real time stream</li>
<li>URIBL</li>
<li>DNSWL.</li>
</ul>

<p>We also apply internal algorithms for de-duplicating, normalizing and scoring each item in our database, providing a seamless and reliable API end-point for your application.</p>

<p>MSQ queries are answered in less than 1 millisecond, and expect no longer then 10 milliseconds for a query reply.</p>

<p>An MQS virtual appliance is also available for on-premises installation for super-fast access. Please contact us for details about that option.</p>

<p>All our sources are updated at very frequent intervals. We are also using real-time streams, so you may rest assured that you get the latest information from MQS.</p>
<h2 id='score-calculation'>Score calculation</h2>
<p>We are calculating the score for each item, based on where it is found, the additional information we have about the item (e.g. exploit type, bot, etc.) and whether it is found in one or more lists.</p>

<p>The minimum score is -0.1, meaning that an item was found in White List only. Score 0 means that the item is not found in our DB, and the maximum score is 1. In general, items with score above 0.35 shall be considered as spam or fraud.</p>
<h1 id='data-sources'>Data Sources</h1><h2 id='ip-addresses-sources'>IP Addresses sources</h2>
<p>We aggregate data from several data streams: </p>

<ul>
<li>Spamhaus PBL</li>
<li>SBL</li>
<li>XBL</li>
<li>CBL</li>
<li>Spamhaus Real-time stream.</li>
</ul>

<p>On the other hand, we have also information about White Lists presence of IP address, for example DNSWL.</p>

<p>Unlike other lists, MQS analyzes the data about each IP address and provides normalized, de-duplicated, and pre-processed information about each IP address, containing internally calculated score (reputation), last modified timestamp, list of BL / WL where the item appears, etc.</p>
<h2 id='domains-sources'>Domains sources</h2>
<p>At this stage we aggregate data from two main Domain providers:</p>

<ul>
<li>Spamhaus DBL and URIBL</li>
<li>Real-time Spamhaus ZRD (Zero Reputation Domains) list.</li>
</ul>

<p>More providers will be added in the near future. Stay tuned!</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="php">php</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
